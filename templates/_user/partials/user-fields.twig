{% import '_user/partials/form-macros' as m %}

{% set inputUsernameAttributes = {
	id: 'username',
	type: 'text',
	name: 'username',
	value: user.username,
	required: true,
} %}
{% set usernameLabel = 'Username'|t('app') %}
{% set usernameErrors = user.getErrors('username') %}

{% set inputEmailAttributes = {
	id: 'email',
	type: 'email',
	name: 'email',
	value: user.email,
	required: true,	
} %}
{% set emailLabel = 'Email'|t('app') %}
{% set emailErrors = user.getErrors('email') %}

{% set inputFullNameAttributes = {
   id: 'fullName',
   type: 'text',
   name: 'fullName',
   value: user.fullName,
   required: true,
} %}
{% set fullNameLabel = 'Full Name'|t('app') %}
{% set fullNameErrors = user.getErrors('fullName') %}

{% set inputPasswordAttributes = {	
	id: 'password',
	type: 'password',
	name: 'password',
	required: user.id is null,
} %}
{% set passwordLabel = user.id is not null ? 'Current Password'|t('app') : 'Password'|t('app') %}
{% set passwordErrors = user.id is not null ? user.getErrors('currentPassword') : user.getErrors('password') %}

{% set newPasswordInputAttributes = {
	id: 'newPassword',
	type: 'password',
	name: 'newPassword',
} %}
{% set newPasswordLabel = user.getErrors('newPassword') %}
{% set newPasswordErrors = 'New Password'|t('app') %}

{# output html #}

{# username #}
{% if not craft.app.config.general.useEmailAsUsername %}
	{{m.formFieldInput(inputUsernameAttributes, usernameLabel, usernameErrors)}}
{% endif %}

{# email #}
{{m.formFieldInput(inputEmailAttributes, emailLabel, emailErrors)}}

{# full name #}
{{m.formFieldInput(inputFullNameAttributes, fullNameLabel, fullNameErrors)}}

{# custom fields #}
{% set fieldsList = user.getFieldLayout().customFields %}
{% for field in fieldsList %}
	{% include '_user/partials/custom-fields' with {
		model: user,
		field: field,
	} only %}
{% endfor %}

{# password #}
{{m.formFieldInput(inputPasswordAttributes, passwordLabel, passwordErrors)}}

{# new pasword #}
{% if user.id is not null %}
	{{m.formFieldInput(newPasswordInputAttributes, newPasswordLabel, newPasswordErrors)}}
{% endif %}